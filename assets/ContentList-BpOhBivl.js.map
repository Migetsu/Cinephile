{"version":3,"file":"ContentList-BpOhBivl.js","sources":["../../src/components/Content/ContentItem.vue","../../src/components/Content/ContentList.vue"],"sourcesContent":["<template>\r\n  <router-link :to=\"page + item.id\" class=\"main__content-item\">\r\n    <img v-lazy=\"indexStore.imageFullUrl + item.backdrop_path\" alt=\"\" class=\"main__content-item-img\">\r\n    <h2 class=\"main__content-item-name\">{{ item.title || item.name }}</h2>\r\n  </router-link>\r\n</template>\r\n\r\n<script setup>\r\nimport { useIndexStore } from '@/store/indexStore.js'\r\n\r\nconst props = defineProps({\r\n    item: Object,\r\n    content: String\r\n})\r\n\r\nconst page = props.content == 'movie' ? '/movie/' : '/tv/'\r\n\r\nconst indexStore = useIndexStore()\r\n</script>\r\n\r\n<style>\r\n\r\n</style>","<template>\r\n    <div class=\"container\">\r\n        <div class=\"main__content\">\r\n            <h2 class=\"main__content-title\">{{ props.content == 'movie' ? 'Все фильмы' : 'Все сериалы' }}</h2>\r\n            <div class=\"main__content-list\">\r\n                <ContentItem v-for=\"item in allMovies\" :key=\"item.id\" :item=\"item\" :content=\"props.content\" />\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport ContentItem from '@/components/Content/ContentItem.vue';\r\nimport { ref, onMounted, watch, onUnmounted } from 'vue'\r\nimport { usePopularMovieStore } from '@/store/modules/popularMovieStore.js'\r\nimport { usePopularTvsStore } from '@/store/modules/popularTvsStore.js'\r\n\r\nconst popularMovieStore = usePopularMovieStore()\r\nconst popularTvsStore = usePopularTvsStore()\r\nconst props = defineProps({\r\n    content: String\r\n})\r\n\r\nconst page = ref(1)\r\nconst loading = ref(false)\r\nconst allMovies = ref([])\r\n\r\nconst getContent = async () => {\r\n    if (!loading.value) {\r\n        loading.value = true\r\n        if (props.content === 'movie') {\r\n            await popularMovieStore.getPopularMovie(page.value)\r\n            allMovies.value = [...allMovies.value, ...popularMovieStore.popularMovies]\r\n        } else {\r\n            await popularTvsStore.getPopularTvs(page.value)\r\n            allMovies.value = [...allMovies.value, ...popularTvsStore.popularTvs]\r\n        }\r\n        loading.value = false\r\n        page.value++\r\n    }\r\n}\r\n\r\nconst handleScroll = () => {\r\n    if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight - 10) {\r\n        getContent()\r\n    }\r\n}\r\n\r\nonMounted(() => {\r\n    getContent()\r\n    window.addEventListener('scroll', handleScroll)\r\n})\r\n\r\nwatch(() => props.content, () => {\r\n    page.value = 1\r\n    allMovies.value = []\r\n    getContent()\r\n})\r\n\r\nonUnmounted(() => {\r\n    window.removeEventListener('scroll', handleScroll)\r\n})\r\n</script>\r\n\r\n<style></style>"],"names":["page","__props","indexStore","useIndexStore","popularMovieStore","usePopularMovieStore","popularTvsStore","usePopularTvsStore","props","ref","loading","allMovies","getContent","handleScroll","onMounted","watch","onUnmounted"],"mappings":"8TAeA,MAAMA,EALQC,EAKK,SAAW,QAAU,UAAY,OAE9CC,EAAaC,EAAe,2aCAlC,MAAMC,EAAoBC,EAAsB,EAC1CC,EAAkBC,EAAoB,EACtCC,EAAQP,EAIRD,EAAOS,EAAI,CAAC,EACZC,EAAUD,EAAI,EAAK,EACnBE,EAAYF,EAAI,EAAE,EAElBG,EAAa,SAAY,CACtBF,EAAQ,QACTA,EAAQ,MAAQ,GACZF,EAAM,UAAY,SAClB,MAAMJ,EAAkB,gBAAgBJ,EAAK,KAAK,EAClDW,EAAU,MAAQ,CAAC,GAAGA,EAAU,MAAO,GAAGP,EAAkB,aAAa,IAEzE,MAAME,EAAgB,cAAcN,EAAK,KAAK,EAC9CW,EAAU,MAAQ,CAAC,GAAGA,EAAU,MAAO,GAAGL,EAAgB,UAAU,GAExEI,EAAQ,MAAQ,GAChBV,EAAK,QAEb,EAEMa,EAAe,IAAM,CAClB,OAAO,YAAc,OAAO,SAAY,SAAS,KAAK,aAAe,IACtED,EAAY,CAEpB,EAEA,OAAAE,EAAU,IAAM,CACZF,EAAY,EACZ,OAAO,iBAAiB,SAAUC,CAAY,CAClD,CAAC,EAEDE,EAAM,IAAMP,EAAM,QAAS,IAAM,CAC7BR,EAAK,MAAQ,EACbW,EAAU,MAAQ,CAAE,EACpBC,EAAY,CAChB,CAAC,EAEDI,EAAY,IAAM,CACd,OAAO,oBAAoB,SAAUH,CAAY,CACrD,CAAC"}
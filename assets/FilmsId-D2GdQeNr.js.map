{"version":3,"file":"FilmsId-D2GdQeNr.js","sources":["../../src/store/modules/movieRecsStore.js","../../src/store/modules/movieTrailerStore.js","../../src/pages/FilmsId.vue"],"sourcesContent":["import { defineStore } from \"pinia\";\r\nimport axios from 'axios';\r\nimport optionsMovieRecs from \"@/assets/scripts/options\";\r\nimport { useIndexStore } from \"@/store/indexStore.js\"\r\n\r\nexport const useMovieRecsStore = defineStore(\"movieRecsStore\", {\r\n    state: () => ({\r\n        path: 'https://api.themoviedb.org/3/movie/',\r\n        recs: null,\r\n    }),\r\n    actions: {\r\n        async getRecs(movieId) {\r\n            this.trailer = null\r\n            try {\r\n                const res = await axios.get(`${this.path}${movieId}/recommendations?language=ru-RU`, optionsMovieRecs)\r\n                const data = res.data\r\n                this.recs = data.results\r\n            } catch (error) {\r\n                console.log(error);\r\n            }\r\n        }\r\n    },\r\n    getters: {\r\n        getMovieRecs: (state) => (count) => {\r\n            return state.recs ? state.recs.slice(0, count) : []\r\n        }\r\n    }\r\n})","import { defineStore } from \"pinia\";\r\nimport axios from 'axios';\r\nimport optionsMovieRecs from \"@/assets/scripts/options\";\r\nimport { useIndexStore } from \"@/store/indexStore.js\"\r\n\r\nexport const useMovieTrailerStore = defineStore(\"movieTrailerStore\", {\r\n    state: () => ({\r\n        path: 'https://api.themoviedb.org/3/movie/',\r\n        trailer: null,\r\n    }),\r\n    actions: {\r\n        async getTrailer(movieId) {\r\n            this.trailer = null\r\n            try {\r\n                const res = await axios.get(`${this.path}${movieId}/videos?language=ru-RU`, optionsMovieRecs)\r\n                const data = res.data\r\n                this.trailer = data\r\n            } catch (error) {\r\n                console.log(error);\r\n            }\r\n        }\r\n    },\r\n    getters: {}\r\n})","<template>\r\n  <div class=\"main\" v-if=\"movie\">\r\n    <div class=\"main__contentId\">\r\n      <div class=\"main__contentId-media\">\r\n        <img :src=\"indexStore.imageFullUrl + movie.backdrop_path\" alt=\"\" class=\"main__contentId-media-poster\">\r\n        <div class=\"main__contentId-media-block\">\r\n          <div class=\"main__contentId-media-left\">\r\n            <h1 class=\"main__contentId-media-left-title\">{{ movie.title }}</h1>\r\n            <p class=\"main__contentId-media-left-text\">{{ movie.overview }}</p>\r\n            <p class=\"main__contentId-media-left-genre\">\r\n              <span class=\"main__contentId-media-date\">{{ new Date(movie.release_date).getFullYear() }}</span>\r\n              <span v-for=\"genre in movie.genres\" :key=\"genre.id\">{{ genre.name }}</span>\r\n            </p>\r\n            <a :href=\"trailer && trailer.results.length ? `https://www.youtube.com/watch?v=${trailer.results[0].key}` : 'https://www.youtube.com/watch?v=dQw4w9WgXcQ'\"\r\n              v-if=\"trailer\" class=\"main__contentId-media-trailer\" target=\"blank\">\r\n              <fa icon=\"play\" class=\"main__contentId-media-icon\" />\r\n              <span class=\"main__contentId-media-span\">Смотреть Трейлер</span>\r\n            </a>\r\n          </div>\r\n          <div class=\"main__contentId-media-right\">\r\n            <img :src=\"indexStore.imageFullUrl + movie.poster_path\" alt=\"\">\r\n          </div>\r\n          <div class=\"main__contentId-media-actors\">\r\n            <h2 class=\"main__contentId-media-title\">В главных ролях</h2>\r\n            <div class=\"main__contentId-media-casts\">\r\n              <Actor type=\"/movie/\" :id=\"movie.id\" :count=\"6\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"main__budgetBlock container\">\r\n      <div class=\"main__budgetBlock-item budgetBlock-title\">Бюджет</div>\r\n      <div class=\"main__budgetBlock-item budgetBlock-title\">Сборы</div>\r\n      <div class=\"main__budgetBlock-item budgetBlock-title\">Статус</div>\r\n      <div class=\"main__budgetBlock-item budgetBlock-title\">Исходное название</div>\r\n      <div class=\"main__budgetBlock-item budgetBlock-descr\">{{ `$${movie.budget.toLocaleString('de-DE')}` }}</div>\r\n      <div class=\"main__budgetBlock-item budgetBlock-descr\">{{ `$${movie.revenue.toLocaleString('de-DE')}` }}</div>\r\n      <div class=\"main__budgetBlock-item budgetBlock-descr\">{{ movie.status }}</div>\r\n      <div class=\"main__budgetBlock-item budgetBlock-descr\">{{ movie.original_title }}</div>\r\n    </div>\r\n    <div class=\"main__recomendations container\">\r\n      <h3 class=\"main__recomendations-title\">Рекомендации</h3>\r\n      <div class=\"main__recomendations-list\">\r\n        <router-link :to=\"page + rec.id\" class=\"main__recomendations-item\" v-for=\"(rec, idx) in recoms\" :key=\"idx\" @click=\"refreshPage(rec.id)\">\r\n          <img v-lazy=\"indexStore.imageFullUrl + rec.backdrop_path\" alt=\"\" class=\"main__recomendations-item-img\">\r\n          <h2 class=\"main__recomendations-item-name\">{{ rec.title }}</h2>\r\n        </router-link>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class=\"loading\" v-else>\r\n    <div class=\"loading__spiner\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { useIndexStore } from \"@/store/indexStore.js\"\r\nimport { useMovieStore } from \"@/store/modules/movieStore.js\"\r\nimport { useMovieRecsStore } from \"@/store/modules/movieRecsStore.js\"\r\nimport { useMovieTrailerStore } from \"@/store/modules/movieTrailerStore.js\"\r\nimport { onMounted, computed, reactive, ref } from \"vue\"\r\nimport { useRoute, useRouter } from 'vue-router';\r\n\r\nconst movieStore = useMovieStore()\r\nconst indexStore = useIndexStore()\r\nconst movieRecsStore = useMovieRecsStore()\r\nconst movieTrailerStore = useMovieTrailerStore()\r\nconst route = useRoute();\r\nconst router = useRouter();\r\nconst countOfRecoms = ref(4)\r\nconst page = '/movie/'\r\n\r\nconst countOfRecs = reactive([1, 2, 3, 4])\r\nconst movie = computed(() => movieStore.movie)\r\nvar trailer = computed(() => movieTrailerStore.trailer)\r\nvar recoms = ref(null)\r\n\r\nonMounted(async () => {\r\n  await fetchMovieData(route.params.id)\r\n});\r\n\r\nconst fetchMovieData = async (movieId) => {\r\n  await movieStore.getMovieById(movieId)\r\n  await movieTrailerStore.getTrailer(movieStore.movie.id)\r\n  await movieRecsStore.getRecs(movieStore.movie.id)\r\n  recoms.value = getCountRecs.value\r\n}\r\n\r\nconst getCountRecs = computed(() => {\r\n  return movieRecsStore.getMovieRecs(countOfRecoms.value)\r\n})\r\n\r\nconst refreshPage = async (movieId) => {\r\n  await fetchMovieData(movieId)\r\n  router.push(`${page}${movieId}`)\r\n  window.scrollTo(0, 0);\r\n}\r\n</script>\r\n\r\n<style></style>"],"names":["useMovieRecsStore","defineStore","movieId","data","axios","optionsMovieRecs","error","state","count","useMovieTrailerStore","page","movieStore","useMovieStore","indexStore","useIndexStore","movieRecsStore","movieTrailerStore","route","useRoute","router","useRouter","countOfRecoms","ref","reactive","movie","computed","trailer","recoms","onMounted","fetchMovieData","getCountRecs","refreshPage"],"mappings":"gNAKO,MAAMA,EAAoBC,EAAY,iBAAkB,CAC3D,MAAO,KAAO,CACV,KAAM,sCACN,KAAM,IACd,GACI,QAAS,CACL,MAAM,QAAQC,EAAS,CACnB,KAAK,QAAU,KACf,GAAI,CAEA,MAAMC,GADM,MAAMC,EAAM,IAAI,GAAG,KAAK,IAAI,GAAGF,CAAO,kCAAmCG,CAAgB,GACpF,KACjB,KAAK,KAAOF,EAAK,OACpB,OAAQG,EAAO,CACZ,QAAQ,IAAIA,CAAK,CACpB,CACJ,CACJ,EACD,QAAS,CACL,aAAeC,GAAWC,GACfD,EAAM,KAAOA,EAAM,KAAK,MAAM,EAAGC,CAAK,EAAI,CAAE,CAE1D,CACL,CAAC,ECtBYC,EAAuBR,EAAY,oBAAqB,CACjE,MAAO,KAAO,CACV,KAAM,sCACN,QAAS,IACjB,GACI,QAAS,CACL,MAAM,WAAWC,EAAS,CACtB,KAAK,QAAU,KACf,GAAI,CAEA,MAAMC,GADM,MAAMC,EAAM,IAAI,GAAG,KAAK,IAAI,GAAGF,CAAO,yBAA0BG,CAAgB,GAC3E,KACjB,KAAK,QAAUF,CAClB,OAAQG,EAAO,CACZ,QAAQ,IAAIA,CAAK,CACpB,CACJ,CACJ,EACD,QAAS,CAAE,CACf,CAAC,8/CCgDKI,EAAO,wCAPb,MAAMC,EAAaC,EAAe,EAC5BC,EAAaC,EAAe,EAC5BC,EAAiBf,EAAmB,EACpCgB,EAAoBP,EAAsB,EAC1CQ,EAAQC,EAAQ,EAChBC,EAASC,EAAS,EAClBC,EAAgBC,EAAI,CAAC,EAGPC,EAAS,CAAC,EAAG,EAAG,EAAG,CAAC,CAAC,EACzC,MAAMC,EAAQC,EAAS,IAAMd,EAAW,KAAK,EAC7C,IAAIe,EAAUD,EAAS,IAAMT,EAAkB,OAAO,EAClDW,EAASL,EAAI,IAAI,EAErBM,EAAU,SAAY,CACpB,MAAMC,EAAeZ,EAAM,OAAO,EAAE,CACtC,CAAC,EAED,MAAMY,EAAiB,MAAO3B,GAAY,CACxC,MAAMS,EAAW,aAAaT,CAAO,EACrC,MAAMc,EAAkB,WAAWL,EAAW,MAAM,EAAE,EACtD,MAAMI,EAAe,QAAQJ,EAAW,MAAM,EAAE,EAChDgB,EAAO,MAAQG,EAAa,KAC9B,EAEMA,EAAeL,EAAS,IACrBV,EAAe,aAAaM,EAAc,KAAK,CACvD,EAEKU,EAAc,MAAO7B,GAAY,CACrC,MAAM2B,EAAe3B,CAAO,EAC5BiB,EAAO,KAAK,GAAGT,CAAI,GAAGR,CAAO,EAAE,EAC/B,OAAO,SAAS,EAAG,CAAC,CACtB"}